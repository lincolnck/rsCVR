function f = groupSubjects(targetDir, os)

if os
if ~exist(targetDir, 'dir') || isempty(targetDir)
    error('The specified target directory: %s does not exist.', targetDir);
end
subTargetDir = dir(fullfile(targetDir,'*'));
nTargetDir = setdiff({subTargetDir([subTargetDir.isdir]).name},{'.','..'});

for ii = 1:numel(nTargetDir)
    subjectName = extractBefore(nTargetDir{ii},"_");
    subjectDir = [targetDir filesep subjectName];
    cmd = sprintf('mkdir -p %s', subjectDir);
    system(cmd, '-echo');
    T = dir(fullfile(targetDir,nTargetDir{ii},'*'));
    C = {T(~[T.isdir]).name}; % files in subfolder.
    for jj = 1:numel(C)
        subjectImage = fullfile(targetDir,nTargetDir{ii},C{jj});
        cmd = sprintf('mv -v %s %s', subjectImage, subjectDir);
        system(cmd, '-echo');
    end
    cmd = sprintf('rm -r %s', [targetDir filesep nTargetDir{ii}]);
    system(cmd, '-echo');
end

%   for d in "$projectdir"/*; do
% 	subject_name=${d/_*}  
% 	mkdir -p "$subject_name"
% 	mv -v $d/* "$subject_name"
% 	rm -r $d
% 	done
%   return 0   # Success.
% }  

% cons_dirs $projectdir