library(dplyr)
library(tidyr)
library(purrr)
library(ggplot2)
library(tidyverse)
library(data.table)
library(readxl)
library(ggpubr)
library(xtable)
wd = '/Volumes/HIV/HIV_Tobacco/FunImg'
results <- read.csv('Results_minor.csv', header=FALSE)
wd = '/Volumes/HIV/HIV/HIV_Tobacco/FunImg'
```{r}
results <- read.csv('Results_minor.csv', header=FALSE)
library(dplyr)
library(tidyr)
library(purrr)
library(ggplot2)
library(tidyverse)
library(data.table)
library(readxl)
library(ggpubr)
library(xtable)
wd = '/Volumes/HIV/HIV/HIV_Tobacco/FunImg'
results <- read.csv(paste(wd, 'Results_minor.csv'), header=FALSE)
paste(wd, 'Results_minor.csv')
paste0(wd, 'Results_minor.csv')
results <- read.csv(paste0(wd, 'Results_minor.csv'), header=FALSE)
wd = '/Volumes/HIV/HIV/HIV_Tobacco/FunImg/'
results <- read.csv(paste0(wd, 'Results_minor.csv'), header=FALSE)
subject_names <- read.csv(paste0(wd, 'subject_list.csv'), header=FALSE)
View(subject_names)
# txt_subject_names <- gsub('^(.{4})(.*)$', '\\1_\\2', subject_names[,])
# whole_roi_names <- c("Frontal", "Parietal", "Temporal", "Limbic", "Occipital", "Insula", "BasalGanglia", "Thalamus", "BasalForebrain", "Midbrain", "Cerebellum")
whole_roi_names <- c("Frontal", "Parietal", "Temporal", "Limbic", "Occipital", "Insula", "BasalGanglia", "Thalamus", "BasalForebrain", "Midbrain", "Cerebellum", "SFG", "SFG_PFC", "SFG_pole", "MFG", "MFG_DPFC", "IFG_opercularis", "IFG_orbitalis", "IFG_triangularis", "LFOG", "MFOG", "RG", "PoCG", "PrCG", "SPG", "SMG", "AG", "PrCu", "STG", "STG_pole", "MTG", "MTG_pole", "ITG", "PHG", "ENT", "FuG", "SOG", "MOG", "IOG", "Cu", "LG", "rostral_ACC", "subcallosal_ACC", "subgenual_ACC", "dorsal_ACC", "PCC", "Insula_minor", "Amygdala", "Hippocampus", "Caudate", "Putamen", "GP", "Thalamus_minor", "Hypothalamus", "AnteriorBasalForebrain", "NucleusAccumbens", "RedNucleus", "SubstantiaNigra", "CerebellumGM", "CP", "Midbrain_minor", "CST", "SCP", "MCP", "PCT", "ICP", "ML", "Pons_minor", "Medulla_minor", "ACR", "SCR", "PCR", "GCC", "BCC", "SCC", "PVWl", "ALIC", "PLIC", "RLIC", "EC", "CGC", "CGH", "FxST", "Fx", "IFO", "PTR", "SS", "SFO", "SLF", "Cl", "PosteriorBasalForebrain", "Mammillary", "OpticTract", "PVWa", "PVWp", "SFWM", "SFWMPFC", "SFWMpole", "MFWM", "MFWM_DPFC", "IFWM_opercularis", "IFWM_orbitalis", "IFWM_triangularis", "LFOWM", "MFOWM", "FGWM", "PoCWM", "PrCWM", "SPWM", "SMWM", "AGWM", "PrCuWM", "STWM", "STWM_pole", "MTWM", "MTWM_pole", "ITWM", "FuWM", "SOWM", "MOWM", "IOWM", "CuWM", "LGWM", "rostralWM_ACC", "subcallosalWM_ACC", "subgenualWM_ACC", "dorsalWM_ACC", "PCCWM", "CerebellumWM", "MCP_cb", "ICP_cb", "FrontSul", "CentralSul", "SylFrontSul", "SylTempSul", "SylParieSul", "ParietSul", "CinguSul", "OcciptSul", "TempSul", "Chroid_LVetc", "ECC", "ECSAnterior", "ECSPosterior")
names(results) <- whole_roi_names
row.names(results) <- t(txt_subject_names)
row.names(results) <- t(subject_names)
View(results)
group_list = read_excel(paste0(wd, 'Sublist_HIV_Tobac.xlsx')
group_list = read_excel(paste0(wd, 'Sublist_HIV_Tobac.xlsx'))
paste0(wd, 'Sublist_HIV_Tobac.xlsx')
wd = '/Volumes/HIV/HIV/HIV_Tobacco/'
results <- read.csv(paste0(wd, 'FunImg/Results_minor.csv'), header=FALSE)
subject_names <- read.csv(paste0(wd, 'FunImg/subject_list.csv'), header=FALSE)
group_list = read_excel(paste0(wd, 'Sublist_HIV_Tobac.xlsx'))
View(group_list)
row.names(group_list) <- group_list$folder
final_df <- merge(results, group_list,by="row.names")
View(final_df)
View(results)
View(subject_names)
View(results)
library(dplyr)
library(tidyr)
library(purrr)
library(ggplot2)
library(tidyverse)
library(data.table)
library(readxl)
library(ggpubr)
library(xtable)
wd = '/Volumes/HIV/HIV/HIV_Tobacco/'
results <- read.csv(paste0(wd, 'FunImg/Results_minor.csv'), header=FALSE)
subject_names <- read.csv(paste0(wd, 'FunImg/subject_list.csv'), header=FALSE)
# txt_subject_names <- gsub('^(.{4})(.*)$', '\\1_\\2', subject_names[,])
# whole_roi_names <- c("Frontal", "Parietal", "Temporal", "Limbic", "Occipital", "Insula", "BasalGanglia", "Thalamus", "BasalForebrain", "Midbrain", "Cerebellum")
whole_roi_names <- c("Frontal", "Parietal", "Temporal", "Limbic", "Occipital", "Insula", "BasalGanglia", "Thalamus", "BasalForebrain", "Midbrain", "Cerebellum", "SFG", "SFG_PFC", "SFG_pole", "MFG", "MFG_DPFC", "IFG_opercularis", "IFG_orbitalis", "IFG_triangularis", "LFOG", "MFOG", "RG", "PoCG", "PrCG", "SPG", "SMG", "AG", "PrCu", "STG", "STG_pole", "MTG", "MTG_pole", "ITG", "PHG", "ENT", "FuG", "SOG", "MOG", "IOG", "Cu", "LG", "rostral_ACC", "subcallosal_ACC", "subgenual_ACC", "dorsal_ACC", "PCC", "Insula_minor", "Amygdala", "Hippocampus", "Caudate", "Putamen", "GP", "Thalamus_minor", "Hypothalamus", "AnteriorBasalForebrain", "NucleusAccumbens", "RedNucleus", "SubstantiaNigra", "CerebellumGM", "CP", "Midbrain_minor", "CST", "SCP", "MCP", "PCT", "ICP", "ML", "Pons_minor", "Medulla_minor", "ACR", "SCR", "PCR", "GCC", "BCC", "SCC", "PVWl", "ALIC", "PLIC", "RLIC", "EC", "CGC", "CGH", "FxST", "Fx", "IFO", "PTR", "SS", "SFO", "SLF", "Cl", "PosteriorBasalForebrain", "Mammillary", "OpticTract", "PVWa", "PVWp", "SFWM", "SFWMPFC", "SFWMpole", "MFWM", "MFWM_DPFC", "IFWM_opercularis", "IFWM_orbitalis", "IFWM_triangularis", "LFOWM", "MFOWM", "FGWM", "PoCWM", "PrCWM", "SPWM", "SMWM", "AGWM", "PrCuWM", "STWM", "STWM_pole", "MTWM", "MTWM_pole", "ITWM", "FuWM", "SOWM", "MOWM", "IOWM", "CuWM", "LGWM", "rostralWM_ACC", "subcallosalWM_ACC", "subgenualWM_ACC", "dorsalWM_ACC", "PCCWM", "CerebellumWM", "MCP_cb", "ICP_cb", "FrontSul", "CentralSul", "SylFrontSul", "SylTempSul", "SylParieSul", "ParietSul", "CinguSul", "OcciptSul", "TempSul", "Chroid_LVetc", "ECC", "ECSAnterior", "ECSPosterior")
names(results) <- whole_roi_names
row.names(results) <- t(subject_names)
group_list = read_excel(paste0(wd, 'Sublist_HIV_Tobac.xlsx'))
row.names(group_list) <- group_list$folder
final_df <- merge(results, group_list,by="row.names")
View(final_df)
final_df_new <- final_df %>%
mutate(Smoker = if_else(grepl("Smoker", final_df$GroupName, fixed = TRUE), 'smoker', 'non-smoker')) %>%
mutate(Disease = if_else(grepl("HIV", final_df$GroupName, fixed = TRUE), 'HIV', 'SN'))
View(final_df_new)
anova_results <- purrr::map(final_df_new[,2:12], ~aov(.x ~ Disease * Smoker, data = final_df_new))
View(anova_results)
summary(anova_results[[10]])
summary(anova_results[[1]])
summary(anova_results[[2]])
sapply(anova_results,function(x)summary(x))
sapply(anova_results,function(x)summary(x))
sapply(anova_results,function(x)TukeyHSD(x))
TukeyHSD(anova_results[[8]])
sapply(anova_results,function(x)TukeyHSD(x))
TukeyHSD(anova_results[[4]])
# Limbic
TukeyHSD(anova_results[[4]])
# Insula
TukeyHSD(anova_results[[6]])
# Thalamus
TukeyHSD(anova_results[[8]])
summary(final_df_new$sex)
summary(final_df_new$Smoker)
summary(final_df_new$Disease)
